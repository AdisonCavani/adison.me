---
import BaseLayout from "@layouts/Base.astro";
import SEO from "@layouts/SEO.astro";
import BlogLayout from "@layouts/Blog.astro";

// Use Astro.glob() to fetch all posts, and then sort them by date.
const posts = (await Astro.glob("./blog/*.md")).sort(
  (a, b) =>
    new Date(b.frontmatter.pubDate).valueOf() -
    new Date(a.frontmatter.pubDate).valueOf()
);

const tagsNotMerged = posts.map((post) => post.frontmatter.tags[0].split(";"));
const tags = [...new Set([].concat.apply([], tagsNotMerged))];
---

<SEO title="Blog" description="Blog">
  <BaseLayout>
    <BlogLayout posts={posts} tags={tags} />
  </BaseLayout>
</SEO>
